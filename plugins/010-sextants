#!/usr/bin/env bash
set -euo pipefail

OUT="${WAYBAR_OUTPUT_NAME:-$(/usr/bin/seasoning which-output 2>/dev/null || echo default)}"
CACHE="${SEASONING_CACHE:-$HOME/.cache/seasoning}/$OUT"
MODE_FILE="$CACHE/mode.010-sextants.state"
mkdir -p "$CACHE"

mode=0
[[ -f "$MODE_FILE" ]] && read -r mode < "$MODE_FILE" || true
mode=$(( mode % 3 ))

# three visibly different mock modes so you can confirm right-clicks
case "$mode" in
  0) txt="|#######   |#####     |######    |" ;;
  1) txt="|11111 11111 11111|00000 00000|" ;;
  2) txt="|01110 01110 01110|00000 00000|" ;;
esac

printf '{"text":"%s","class":"mid--010-sextants"}\n' "$txt"
